<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>HRIS - Schedule</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- App Icons -->
    <link rel="shortcut icon" th:href="@{/dist/img/favicon.ico}">
    <div th:replace="fragments/headerAdm::cssAdm"></div>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
    <link th:href="@{/plugins/bootstrap-datepicker/css/bootstrap-datepicker.min.css}" rel="stylesheet" type="text/css" />
    <link th:href="@{/dist/css/bootstrap-material-datetimepicker.css}" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <div th:replace="fragments/footer::js"></div>
    <script th:src="@{/dist/js/bootstrap.min.js}"></script>
    <script th:src="@{/dist/js/moment-with-locales.min.js}"></script>
    <script th:src="@{/dist/js/bootstrap-material-datetimepicker.js}"></script>
    <style>
        .accordion {
            width: auto;
            max-width: 1000px;
            margin: 2rem auto;
        }
        .accordion-item {
            background-color: #4bbbce;
            color: #fff;
            margin: 1rem 0;
            border-radius: 0.5rem;
            box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.25);
        }

        .accordion-item-header {
            padding: 0.5rem 3rem 0.5rem 1rem;
            min-height: 3.5rem;
            line-height: 1.25rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            position: relative;
            cursor: pointer;
        }

        .accordion-item-header::after {
            content: "\002B";
            font-size: 2rem;
            position: absolute;
            right: 1rem;
        }

        .accordion-item-header.active::after {
            content: "\2212";
        }

        .accordion-item-body {
            background-color: #fff;
            color: #111;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.2s ease-out;
        }

        .accordion-item-body-content {
            padding: 1rem;
            line-height: 1.5rem;
            border-top: 1px solid;
            border-image: linear-gradient(to right, transparent, #34495e, transparent) 1;
        }

        a:link{
            text-decoration: none;
            color: #fff;
        }

        a:visited{
            text-decoration: none;
            color: #fff;
        }
    </style>
</head>

<body> 
    <!-- Loader -->
    <div id="preloader">
        <div id="status">
            <div class="spinner"></div>
        </div>
    </div>

    <div class="header-bg">

        <div th:replace="fragments/headerAdm::headerAdm"></div>

        <div class="container-fluid">
            <!-- Page-Title -->
            <div class="row">
                <div class="col-sm-12">
                    <div class="page-title-box">
                        <h4 class="page-title">Training Scheduling</h4>
                        <button data-toggle="modal" data-target="#addModal" style="color: #ffffff" class="btn"><h4><i class="fa fa-plus-circle"></i> Add New Training Schedule</h4></button> 
                    </div>
                </div>
            </div>
                
            <!-- The Modal Add-->
            <div class="modal fade" id="addModal">
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content">
                        <form th:action="@{/saveScheduleTraining}" method="POST" id="formAddSchedule" role="form">
                            <!-- Modal Header -->
                            <div class="modal-header">
                                <h4 class="modal-title"><i class="fa fa-edit"></i> Add New Training </h4>
                                <button type="button" class="close" data-dismiss="modal" style="color: #4bbbce">&times;</button>
                            </div>
                            <!-- Modal body AddSchedule-->
                            <div class="modal-body" style="overflow: auto;">
                                <div class="form-group row">
                                    <label for="training" class="col-sm-2 col-form-label">Type of training</label>
                                    <div class="col-sm-10">
                                        <select class="form-control" id="typeTraining" name="typeTraining">
                                            <option disabled="disabled" selected="selected" >
                                                Choose Option
                                            </option>
                                            <option value="1">Online Class</option>
                                            <option value="0">Offline Class</option>
                                        </select>
                                    </div>
                                </div>                                                        
                                <div class="form-group row">
                                    <label for="training" class="col-sm-2 col-form-label">Title</label>
                                    <div class="col-sm-10">
                                        <!--<input  id="addTraining" type="text"  name="term" class="form-control" >-->
                                        <select class="form-control" id="addTraining" name="term">
                                            <option disabled="disabled" selected="selected" >
                                                Choose Option
                                            </option>
                                        </select>
                                        <input  id="addTrainingID" type="hidden"  name="term" class="form-control" >
                                    </div>
                                </div>                                                        
                                <div class="form-group row">
                                    <label for="reqDate" class="col-sm-2 col-form-label">Date</label>
                                    <div class="col-sm-10">
                                        <!--<input type="text" id="datepicker" class="form-control">-->
                                        <div class="input-group">
                                            <input type="text" id="reqDate" name="reqDate" class="form-control">
                                            <div class="input-group-append">
                                                <label class="input-group-text" for="reqDate">
                                                    <i class="fa fa-calendar"></i>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="reqTime" class="col-sm-2 col-form-label">Time</label>
                                    <div class="col-sm-10">
                                        <div class="input-group">
                                            <input type="text" name="reqTime" id="reqTime" class="form-control time">
                                            <div class="input-group-append">
                                                <label class="input-group-text" for="reqTime">
                                                    <i class="fa fa-clock-o"></i>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="quota" class="col-sm-2 col-form-label">Quota</label>
                                    <div class="col-sm-10">
                                        <input type="number" id="quota" name="reqQuota" class="form-control" maxlength="11" required="">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="trainer" class="col-sm-2 col-form-label">Trainer</label>
                                    <div class="col-sm-10">
                                        <select class="form-control" id="trinerList" name="reqTrainer">
                                            <option disabled="disabled" selected="selected" >
                                                -- Blank --
                                            </option>
                                        </select>

                                        <input type="text" id="parseName" name="trainerName" hidden="" readonly="">

                                    </div>
                                </div>
                                <div class="form-group row" id="rowLocation">
                                    <label for="lokasi" class="col-sm-2 col-form-label">Location</label>
                                    <div class="col-sm-10">
                                        <input type="text" id="lokasi" placeholder="Type Location here" name="reqLocation" class="form-control">
                                    </div>
                                </div>
                                <div class="form-group row" id="rowLink">
                                    <label for="linkTraining" class="col-sm-2 col-form-label">Link</label>
                                    <div class="col-sm-10">
                                        <input type="text" id="linkTraining" placeholder="Type Link here" name="linkTraining" class="form-control">
                                    </div>
                                </div>
                                <div id="rowNeed" class="form-group row">
                                    <label for="reqRequirement" class="col-sm-2 col-form-label">Note</label>
                                    <div class="col-sm-10">
                                        <textarea id="noteTraining" class="form-control" name="reqRequirement"  rows="3" maxlength="200"></textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="submit" id="submitSchedule" class="btn btn-primary mb-2">Save</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <!-- end page title end breadcrumb -->
        </div>
    </div>

    <!-- start wrapper -->
    <div class="wrapper">
        <!-- start container -->
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <div class="card m-b-20">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-sm-6">
                                    <h4 class="font-weight-bold float-left">List Training</h4>
                                </div>
                                <div class="col-sm-6">
                                    <input type="text" placeholder="Search..." id="search-filter" class="float-right app-search">
                                </div>
                            </div>
                            <hr>
                            
                            <ul class="nav nav-tabs nav-tabs-custom nav-justified" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" data-toggle="tab" href="#onlineClass" role="tab">
                                        <span class="d-none d-md-block">Online Class</span><span class="d-block d-md-none"><i class="dripicons-suitcase h5"></i></span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#offlineClass" role="tab">
                                        <span class="d-none d-md-block">Offline Class</span><span class="d-block d-md-none"><i class="dripicons-clock h5"></i></span>
                                    </a>
                                </li>
                            </ul>
                            
                            <div class="tab-content">
                                <div class="tab-pane active p-3" id="onlineClass" role="tabpanel">
                                    <div class="accordion">
                                        <div class="accordion-item" th:each="trn : ${trainingListOnline}">
                                            <div class="acc-container" th:if="${dl[0] == trn[0]}" th:each="dl : ${detailListOnline}">
                                                <div class="accordion-item-header">
                                                    <div class="panel-heading simple">
                                                        <h4 class="panel-title mt-1 mb-0" id="judul" aria-expanded="true"
                                                            aria-controls="collapseUnfiled"  th:text  ="${trn[1]}">
                                                        </h4>
                                                        <h6 th:text="${dl[4]}"></h6>
                                                    </div>
                                                </div>
                                                <div class="accordion-item-body">
                                                    <div class="accordion-item-body-content">
                                                        <div class="form-group row ml-auto" style="margin: 0;">
                                                            <label class="col-md-3 label-request">Date</label>
                                                            <p class="float-right">:</p>
                                                            <p class="col-md-6" th:text="${dl[4]}"></p>
                                                        </div>
                                                        <div class="form-group row ml-auto" style="margin: 0;">
                                                            <label class="col-md-3 label-request">Trainer</label>
                                                            <p class="float-right">:</p>
                                                            <p class="col-md-6" th:text="${dl[2]}"></p>
                                                        </div>
                                                        <div class="form-group row ml-auto" style="margin: 0;">
                                                            <label class="col-md-3 label-request">Time</label>
                                                            <p class="float-right">:</p>
                                                            <p class="col-md-6" th:text="${dl[5]+ ' WIB'}"></p>
                                                        </div>
                                                        <div class="form-group row ml-auto" style="margin: 0;">
                                                            <label class="col-md-3 label-request">Quota</label>
                                                            <p class="float-right">:</p>
                                                            <p class="col-md-6" th:text="${dl[3]}"></p>
                                                        </div>
                                                        <div class="form-group row ml-auto" style="margin: 0;">
                                                            <label class="col-md-3 label-request">Link</label>
                                                            <p class="float-right">:</p>
                                                            <p class="col-md-6" th:text="${dl[6]}"></p>
                                                        </div>
                                                        <div>
                                                            <button th:data-id="${trn[0]}" class="btn btn-outline-danger float-right" th:onclick="'javascript:onlineCancel(\''+${trn[0]}+'\');'" style="margin-left: 5px"><i class="fa fa-times"></i> Cancel</button>
                                                        </div>
                                                        <div>
                                                            <button class="btn btn-outline-info float-right" id="edit" th:onclick="'javascript:editFormOnline(\''+${trn[0]}+'\');'"><i class="fa fa-edit"></i> Edit</button>
                                                        </div>
                                                        <br>
                                                        <br>
                                                    </div>
                                                    <div class="modal fade" th:id="${'editModalOnline'+trn[0]}">
                                                        <div class="modal-dialog modal-lg modal-dialog-centered">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h4 class="modal-title"><i class="fa fa-edit"></i> Edit Training</h4>
                                                                    <button type="button" class="close" data-dismiss="modal" style="color: #4bbbce">&times;</button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <form th:action="${'./EditScheduleOnline/'+trn[0]}" method="POST" role="form" th:id="${'editFormScheduleOnline'+trn[0]}">

                                                                        <div class="form-group row">
                                                                            <label for="term" class="col-sm-2 col-form-label">Title</label>
                                                                            <div class="col-sm-10">
                                                                                <input th:value="${dl[1]}" readonly="true" th:id="${'editOnlineTraining'+trn[0]}" type="text"  name="term" class="editTraining form-control">                                     
                                                                            </div>
                                                                        </div>                                                        
                                                                        <div class="form-group row">
                                                                            <label for="upDate" class="col-sm-2 col-form-label">Date</label>
                                                                            <div class="col-sm-10">
                                                                                <input th:value="${dl[4]}" readonly="true" type="text" class="form-control" name="upDate">
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-group row">
                                                                            <label for="upTime" class="col-sm-2 col-form-label">Time</label>
                                                                            <div class="col-sm-10">
                                                                                <input th:value="${dl[5]}" readonly="true" type="text" name="upTime" class="form-control">
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-group row">
                                                                            <label for="upQuota" class="col-sm-2 col-form-label">Quota</label>
                                                                            <div class="col-sm-10">
                                                                                <input th:value="${dl[3]}" readonly="true" type="number" name="upQuota" class="form-control" maxlength="11" required="">
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-group row">
                                                                            <label for="upTrainer" class="col-sm-2 col-form-label">Trainer</label>
                                                                            <div class="col-sm-10">
                                                                                <select class="form-control editTrinerListOnline" th:id="${'listTrainerOnline'+trn[0]}" name="upTrainer">
                                                                                    <option disabled="disabled" selected="selected">-- Blank --</option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-group row">
                                                                            <label for="upRequirement" class="col-sm-2 col-form-label">Link</label>
                                                                            <div class="col-sm-10">
                                                                                <textarea th:text="${dl[6]}" readonly="true" class="form-control" name="upRequirement"  rows="3" maxlength="200" required=""></textarea>
                                                                            </div>
                                                                        </div>
                                                                        <div class="text-center">
                                                                            <button type="submit" class="t btn btn-primary mb-2">Save</button>
                                                                        </div>
                                                                    </form>
                                                                </div>                                              
                                                                <div class="modal-footer">                                                         
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane p-3" id="offlineClass" role="tabpanel">
                                    <div class="accordion">
                                        <div class="accordion-item" th:each="trn : ${trainingListOffline}">
                                            <div class="acc-container" th:if="${dl[0] == trn[0]}" th:each="dl : ${detailListOffline}">
                                                <div class="accordion-item-header">
                                                    <div class="panel-heading simple">
                                                        <h4 class="panel-title mt-1 mb-0" id="judulOnline" aria-expanded="true" aria-controls="collapseUnfiled"  th:text="${trn[1]}"></h4>
                                                        <h6 th:text="${dl[5]}"></h6>
                                                    </div>
                                                </div>
                                                <div class="accordion-item-body">
                                                    <div class="accordion-item-body-content">
                                                        <div class="form-group row ml-auto" style="margin: 0;">
                                                            <label class="col-md-3 label-request">Date</label>
                                                            <p class="float-right">:</p>
                                                            <p class="col-md-6" th:text="${dl[5]}"></p>
                                                        </div>
                                                        <div class="form-group row ml-auto" style="margin: 0;">
                                                            <label class="col-md-3 label-request">Trainer</label>
                                                            <p class="float-right">:</p>
                                                            <p class="col-md-6" th:text="${dl[2]}"></p>
                                                        </div>
                                                        <div class="form-group row ml-auto" style="margin: 0;">
                                                            <label class="col-md-3 label-request">Time</label>
                                                            <p class="float-right">:</p>
                                                            <p class="col-md-6" th:text="${dl[6]+ ' WIB'}"></p>
                                                        </div>
                                                        <div class="form-group row ml-auto" style="margin: 0;">
                                                            <label class="col-md-3 label-request">Quota</label>
                                                            <p class="float-right">:</p>
                                                            <p class="col-md-6" th:text="${dl[3]}"></p>
                                                        </div>
                                                        <div class="form-group row ml-auto" style="margin: 0;">
                                                            <label class="col-md-3 label-request">Location</label>
                                                            <p class="float-right">:</p>
                                                            <p class="col-md-6" th:text="${dl[4]}"></p>
                                                        </div>
                                                        <div class="form-group row ml-auto" style="margin: 0;">
                                                            <label class="col-md-3 label-request">Note</label>
                                                            <p class="float-right">:</p>
                                                            <p class="col-md-6" th:text="${dl[7]}"></p>
                                                        </div>
                                                        <div>
                                                            <button class="btn btn-outline-danger float-right" id="cancel" th:onclick="'javascript:onlineCancel(\''+${trn[0]}+'\');'" style="margin-left: 5px"><i class="fa fa-times"></i> Cancel</button>
                                                        </div>
                                                        <div>
                                                            <button  class="btn btn-outline-info float-right" id="edit" th:onclick="'javascript:editFormOffline(\''+${trn[0]}+'\');'"><i class="fa fa-edit"></i> Edit</button>
                                                        </div>
                                                        <br>
                                                        <br>
                                                    </div>
                                                    <div class="modal fade" th:id="${'editModalOffline'+trn[0]}">
                                                        <div class="modal-dialog modal-lg modal-dialog-centered">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h4 class="modal-title"><i class="fa fa-edit"></i> Edit Training</h4>
                                                                    <button type="button" class="close" data-dismiss="modal" style="color: #4bbbce">&times;</button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <form th:action="${'./EditScheduleOffline/'+trn[0]}" method="POST" role="form"  th:id="${'editFormScheduleOffline'+trn[0]}">

                                                                        <div class="form-group row">
                                                                            <label for="term" class="col-sm-2 col-form-label">Title</label>
                                                                            <div class="col-sm-10">
                                                                                <input th:value="${dl[1]}" readonly="true" th:id="${'tittleOffline'+trn[0]}" type="text" name="term" class="form-control offlineTittle">                                     
                                                                            </div>
                                                                        </div>                                                        
                                                                        <div class="form-group row">
                                                                            <label for="upDate" class="col-sm-2 col-form-label">Date</label>
                                                                            <div class="col-sm-10">
                                                                                <input th:value="${dl[5]}" readonly="true" type="text" class="form-control" name="upDate">
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-group row">
                                                                            <label for="upTime" class="col-sm-2 col-form-label">Time</label>
                                                                            <div class="col-sm-10">
                                                                                <input th:value="${dl[6]}" readonly="true" type="text" name="upTime" class="form-control">
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-group row">
                                                                            <label for="upQuota" class="col-sm-2 col-form-label">Quota</label>
                                                                            <div class="col-sm-10">
                                                                                <input th:value="${dl[3]}" readonly="true" type="number" name="upQuota" class="form-control" maxlength="11" required="">
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-group row">
                                                                            <label for="upTrainer" class="col-sm-2 col-form-label">Trainer</label>
                                                                            <div class="col-sm-10">
                                                                                <select class="form-control editTrinerListOffline" name="upTrainer" th:id="${'trinerListOffline'+trn[0]}">
                                                                                    <option disabled="disabled" selected="selected">-- Blank --</option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-group row">
                                                                            <label for="upLocation" class="col-sm-2 col-form-label">Location</label>
                                                                            <div class="col-sm-10">
                                                                                <input th:value="${dl[4]}" readonly="true" type="text" placeholder="Type Location here" pattern=".{5,}"   required title="5 characters minimum" name="upLocation" maxlength="200" class="form-control">
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-group row">
                                                                            <label for="upRequirement" class="col-sm-2 col-form-label">Note</label>
                                                                            <div class="col-sm-10">
                                                                                <textarea th:text="${dl[7]}" readonly="true" class="form-control" name="upRequirement"  rows="3" maxlength="200" required=""></textarea>
                                                                            </div>
                                                                        </div>
                                                                        <div class="text-center">
                                                                            <button type="submit" class="t btn btn-primary mb-2">Save</button>
                                                                        </div>
                                                                    </form>
                                                                </div>                                              
                                                                <div class="modal-footer">                                                         
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> 
        <!-- end container -->
    </div>
    <!-- end wrapper -->


    <!-- Footer -->
    <div th:replace="fragments/footerAdm::footerAdm"></div>
    <!-- End Footer -->

    
    <script th:src="@{/dist/js/session.js}"></script>
    <script th:src="@{/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js}"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@8"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>
    <script th:src="@{/dist/js/jquery.validate.min.js}"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            $('#reqTime').bootstrapMaterialDatePicker({
                date: false,
                shortTime: false,
                format: 'HH:mm'
            });
        });
    </script>
    <script>
        const accordionItemHeaders = document.querySelectorAll(".accordion-item-header");

        accordionItemHeaders.forEach(accordionItemHeader => {
            accordionItemHeader.addEventListener("click", event => {

                // Uncomment in case you only want to allow for the display of only one collapsed item at a time!

                // const currentlyActiveAccordionItemHeader = document.querySelector(".accordion-item-header.active");
                // if(currentlyActiveAccordionItemHeader && currentlyActiveAccordionItemHeader!==accordionItemHeader) {
                //   currentlyActiveAccordionItemHeader.classList.toggle("active");
                //   currentlyActiveAccordionItemHeader.nextElementSibling.style.maxHeight = 0;
                // }

                accordionItemHeader.classList.toggle("active");
                const accordionItemBody = accordionItemHeader.nextElementSibling;
                if (accordionItemHeader.classList.contains("active")) {
                    accordionItemBody.style.maxHeight = accordionItemBody.scrollHeight + "px";
                }
                else {
                    accordionItemBody.style.maxHeight = 0;
                }

            });
        });
        
        $('#reqDate').datepicker({
            startDate: '0d',
            format: "dd MM yyyy",
            todayHighlight: true,
            toggleActive: true
        }).on('changeDate', function(selected) {
            var reqTittle = $('#addTraining').val();
            var reqDate = $('#reqDate').val();
            $.ajax({
                url: "/HRIS/scheduleCheck?term=" + reqTittle,
                dataType: 'json',
                success: function (data) {
                    if (data[1] === reqDate) {
                        Swal.fire(
                            'Warning',
                            'Can\'t schedule the same training at the same date!',
                            'warning'
                        );
                    }
                }
            });
        });
        
        $(document).ready(function() {
            
            $('#formAddSchedule').validate({
               rules: {
                   typeTraining: "required",
                   term: "required",
                   reqDate: "required",
                   reqTime: "required",
                   reqQuota: "required",
                   reqTrainer: "required",
                   reqLocation: "required",
                   linkTraining: "required",
                   reqRequirement: "required"
               },messages: {
                    typeTraining: {
                        required: "Please choice a type training."
                    },
                    term: {
                        required: "Please enter a tittle."
                    },
                    reqDate: {
                        required: "Please enter a date training."
                    },
                    reqTime: {
                        required: "Please enter a time training.",
                        minlength: "Your content must consist of at least 5 characters"
                    },
                    reqQuota: {
                        required: "Please enter a quota."
                    },
                    reqTrainer: {
                        required: "Please choice a trainer name."
                    },
                    reqLocation: {
                        required: "Please enter a location."
                    },
                    linkTraining: {
                        required: "Please enter a link training."
                    },
                    reqRequirement: {
                        required: "Please enter a need to bring.",
                        minlength: "Your content must consist of at least 5 characters"
                    }
                },
                errorElement: "em",
                errorPlacement: function (error, element) {
                    // Add the `help-block` class to the error element
                    error.addClass("invalid-feedback");

                    if (element.parent('.input-group').length) {
                        error.insertAfter(element.parent());
                    } else if (element.hasClass('select2')) {
                        error.insertAfter(element.parent());
                    } else {
                        error.insertAfter(element);
                    }
                },
                highlight: function (element, errorClass, validClass) {
                    $(element).addClass('is-invalid').removeClass("is-valid");
                },
                unhighlight: function (element, errorClass, validClass) {
                    $(element).addClass('is-valid').removeClass("is-invalid");

                },
                submitHandler: function (form) {
                    $(form).find(':submit').prop('disabled', true);
                    fomm.submit();
                }
            });
            
            var path = window.location.pathname.split("/");
            var hris_path = path[1];
            $("#rowLink").hide().prop('required', false);
            $('#typeTraining').on('change', function() {
                var typeOfTraining = $(this).val();
                if (typeOfTraining == "1") {
                    $("#rowLink").show();
                    $("#rowLocation, #rowNeed").hide().prop('required', false);
                } else if(typeOfTraining == "0") {
                    $("#rowLocation, #rowNeed").show();
                    $("#rowLink").hide().prop('required', false);
                }

            });
            
            var array = [];
            $.ajax({
                url: '/'+ hris_path +'/trainingSelect2',
                type: 'GET',
                dataType: 'json',
                success: function (items) {
//                    console.log(items);
                    for (var dataArray in items.data) {
                        array.push({id:items.data[dataArray].id, text: items.data[dataArray].text});
                        $("#addTraining").select2({
                            data: array
                        });
                    }
                }
            });
            
            $('#addTraining').change(function () {
//                console.log("adata:", this.value);
                $.getJSON("/HRIS/trainingSearchID?term=" + this.value, {
                    ajax: 'true'
                }, function (data) {
                    try {
//                        console.log("data", data);
                        if (data.length >= 1) {
//                            console.log("Data[0]:", data[0])
                            $.getJSON("/HRIS/getDropdownList?term=" + data[0], {
                                ajax: 'true'
                            }, function (dataTrainer) {
                                var trainerData = dataTrainer;
                                if (trainerData == "") {
                                    var html = '<option disabled="disabled" selected="selected">Not Found Result</option>';
                                    $('#trinerList').html(html);
                                } else {
//                                  console.log("blaba:", dataTrainer[0][1]);
                                    var html = '<option disabled="disabled" selected="selected">Choose Trainer</option>';
                                    var len = dataTrainer.length;
                                    for (var i = 0; i < len; i++) {
                                        html += '<option value="' + dataTrainer[i][2] + '">'
                                                + dataTrainer[i][1] + '</option>';
                                    }
                                    html += '</option>';
                                    $('#trinerList').html(html);
                                }
                            });
                        }
                    } catch (e) {
                        console.log("data err");
                    }
                });
            });
            
        });
        
        $('#formAddSchedule').on('submit', function(e) {
            e.preventDefault();
            var form = this;
            var typeTraininig = $('#typeTraining').val();
            var tittleTraining = $('#addTraining').val();
            var dateTraining = $('#reqDate').val();
            var quoataTraining = $('#quota').val();
            var nameTrainer = $('#trinerList').val();
            if (typeTraininig === '' || tittleTraining === '' || dateTraining === '' || quoataTraining === '' || nameTrainer === null) {
                Swal.fire({
                    type: 'warning',
                    title: 'Sorry...',
                    showConfirmButton: true,
                    text: "Please fill all fields"
                });
            } else {
                Swal.fire({
                    title: 'Are you sure?',
                    text: "You will save this schedule!",
                    type: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Yes, saved!'
                }).then((result) => {
                    if (result.value) {
                        Swal.fire({
                            title: 'Saved!',
                            type: 'success',
                            text: 'Your schedule has been saved!',
                            showConfirmButton: false,
                            timer: 5000
                        });
                        form.submit();
                    }
                });
            }
        });
        
        function editFormOnline(id) {
            $('#editModalOnline'+id).modal("show");
            var tittleOnline = $('#editOnlineTraining'+id).val();
            $.getJSON("/HRIS/trainingSearchID?term=" + tittleOnline, {
                ajax: 'true'
            }, function (data) {
                try {
//                        console.log("data", data);
                    if (data.length >= 1) {
//                            console.log("Data[0]:", data[0])
                        $.getJSON("/HRIS/getDropdownList?term=" + data[0], {
                            ajax: 'true'
                        }, function (dataTrainer) {
                            var trainerData = dataTrainer;
                            if (trainerData == "") {
                                var html = '<option disabled="disabled" selected="selected">Not Found Result</option>';
                                $('.editTrinerListOnline').html(html);
                            } else {
//                                  console.log("blaba:", dataTrainer[0][1]);
                                var html = '<option disabled="disabled" selected="selected">Choose Trainer</option>';
                                var len = dataTrainer.length;
                                for (var i = 0; i < len; i++) {
                                    html += '<option value="' + dataTrainer[i][2] + '">'
                                            + dataTrainer[i][1] + '</option>';
                                }
                                html += '</option>';
                                $('.editTrinerListOnline').html(html);
                            }
                        });
                    }
                } catch (e) {
                    console.log("data err");
                }
            });
            
            $('#editFormScheduleOnline'+id).on('submit', function(e) {
                e.preventDefault();
                var form = this;
                var nameTrainerOnline = $('#listTrainerOnline'+id).val();
                if (nameTrainerOnline === null) {
                    Swal.fire({
                        type: 'warning',
                        title: 'Sorry...',
                        showConfirmButton: true,
                        text: "Please choose a trainer"
                    });
                } else {
                    Swal.fire({
                        title: 'Are you sure?',
                        text: "You will edit this schedule!",
                        type: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Yes, edited!'
                    }).then((result) => {
                        if (result.value) {
                            Swal.fire({
                                title: 'Saved!',
                                type: 'success',
                                text: 'Your schedule has been edited!',
                                showConfirmButton: false,
                                timer: 5000
                            });
                            form.submit();
                        }
                    });
                }
            });
        }
        
        function editFormOffline(id) {
            $('#editModalOffline'+id).modal("show");
            var tittleOffline = $('#tittleOffline'+id).val();
            $.getJSON("/HRIS/trainingSearchID?term=" + tittleOffline, {
                ajax: 'true'
            }, function (data) {
                try {
//                        console.log("data", data);
                    if (data.length >= 1) {
//                            console.log("Data[0]:", data[0])
                        $.getJSON("/HRIS/getDropdownList?term=" + data[0], {
                            ajax: 'true'
                        }, function (dataTrainer) {
                            var trainerData = dataTrainer;
                            if (trainerData == "") {
                                var html = '<option disabled="disabled" selected="selected">Not Found Result</option>';
                                $('.editTrinerListOffline').html(html);
                            } else {
//                                  console.log("blaba:", dataTrainer[0][1]);
                                var html = '<option disabled="disabled" selected="selected">Choose Trainer</option>';
                                var len = dataTrainer.length;
                                for (var i = 0; i < len; i++) {
                                    html += '<option value="' + dataTrainer[i][2] + '">'
                                            + dataTrainer[i][1] + '</option>';
                                }
                                html += '</option>';
                                $('.editTrinerListOffline').html(html);
                            }
                        });
                    }
                } catch (e) {
                    console.log("data err");
                }
            });
            
            $('#editFormScheduleOffline'+id).on('submit', function(e) {
                e.preventDefault();
                var form = this;
                var namaTrainerOffline = $('#trinerListOffline'+id).val();
                if (namaTrainerOffline === null) {
                    Swal.fire({
                        type: 'warning',
                        title: 'Sorry...',
                        showConfirmButton: true,
                        text: "Please choose a trainer"
                    });
                } else {
                    Swal.fire({
                        title: 'Are you sure?',
                        text: "You will edit this schedule!",
                        type: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Yes, edited!'
                    }).then((result) => {
                        if (result.value) {
                            Swal.fire({
                                title: 'Saved!',
                                type: 'success',
                                text: 'Your schedule has been edited!',
                                showConfirmButton: false,
                                timer: 5000
                            });
                            form.submit();
                        }
                    });
                }
            });
        }
        
        function onlineCancel(id) {
            Swal.fire({
                title: 'Reason to cancel',
                input: 'text',
                inputAttributes: {
                    autocapitalize: 'off'
                },
                showCancelButton: true,
                confirmButtonText: 'Submit',
                showLoaderOnConfirm: true
            }).then((result) => {
                if (result.value) {
                    var remark = result.value;
                    Swal.fire({
                        title: 'Are you sure?',
                        text: "You won't be able to revert this!",
                        type: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Yes!'
                    }).then((result) => {
                        if (result.value) {
                            Swal.fire(
                              'Success!',
                              'Your schedule has been canceled.',
                              'success'
                            );
                            $.ajax({
                                url: "/HRIS/cancelScheduleOnline?id=" +id+ "&reason=" +remark,
                                type: "GET"
                            });
                            setTimeout(function () {
                                location.reload();
                            }, 550);
                        } else if (result.dismiss === Swal.DismissReason.cancel) {
                            Swal.fire('Cancelled', 'Your schedule is safe :)', 'error');
                        }
                    });
                }
            });
        }
    </script>
    
    <script th:inline="javascript">
        $(document).ready(function () {
            $("#search-filter").on("keyup", function () {
                var value = $(this).val().toLowerCase();
                console.log(value);
                $("#accordion .acc-container").filter(function () {
                    console.log($(this).toggle($(this).text().toLowerCase().indexOf(value) > - 1));
                    $(this).toggle($(this).text().toLowerCase().indexOf(value) > - 1);
                });
            });
        });
    </script>
</body>
</html>
